# Архитектура проекта
В проекте используется паттерн **MVC (Model-View-Controller)**.
Связь между слоями реализована через событийный брокер EventEmitter, который инкапсулирует подписку и генерацию событий. Это позволяет модулям взаимодействовать только через события, не зная напрямую друг о друге.

## EventEmitter
События используются для:
* получения данных от пользователя (клик, ввод текста, отправка формы);
* передачи данных в интерфейс (обновление корзины, открытие/закрытие модальных окон, переход между экранами).

Пример использования событий:
```ts
button.addEventListener('click', () => eventEmitter.emit('basket:add', productId));
eventEmitter.on('basket:add', (productId) => { /* обработка добавления товара */ });
```

## data/card.ts
**Назначение:** отображение товаров в карточках разных типов:
— в каталоге (`Card`),
— в модальном окне (`CardPreview`),
— в корзине (`CardBasket`).

### `Card`
* Показывает краткую информацию о товаре .
* Может вызывать колбэк при клике.
* Метод `draw` создаёт DOM-элемент карточки.

### `CardPreview`
* Отображает товар в виде модального окна с подробным описанием.
* Имеет кнопку "В корзину".
* Метод `draw` создаёт DOM-элемент превью.

### `CardBasket`
* Показывает товар в корзине с порядковым номером и ценой.
* Есть кнопка удаления товара.
* Метод `draw` создаёт DOM-элемент для корзины.

## data/contacts.ts
**Назначение:** форма для ввода контактных данных пользователя (телефон и email).
### data/contacts`
* Позволяет вводить и отслеживать значения полей.
* Генерирует событие `custom:change`, когда данные изменяются.
* Метод `setValues` устанавливает начальные значения.
* Метод `valid` проверяет, что поля не пустые.
* Метод `get value()` возвращает текущие данные.

##  data/form.ts
**Назначение:** управление этапами оформления заказа.
### `Form`
* Обрабатывает переход между шагами (доставка → контакты → подтверждение).
* Метод `toggle` включает/выключает форму.
* Метод `setStep` переключает текущий этап.
* Метод `valid` проверяет корректность данных на текущем шаге.
* Метод `get value()` возвращает значения полей формы.

## data/modal.ts
**Назначение:** управление модальным окном.
### `Modal`
* Управляет показом/скрытием модального окна.
* Метод `open` вставляет содержимое и открывает модалку.
* Метод `close` закрывает её.
* Поддерживает обработку клика на крестик и `Escape`.

## data/page.ts
**Назначение:** рендеринг и обновление различных элементов страницы (каталог, корзина, форма, кнопки).
### `Page`
* Управляет отрисовкой карточек каталога и корзины.
* Обновляет состояние кнопки "Оформить заказ" и итоговой суммы.
* Метод `setCatalog` отрисовывает каталог.
* Метод `setBasket` отрисовывает корзину.
* Метод `setOrderButtonState` включает/выключает кнопку заказа.
* Метод `setOrderTotal` отображает сумму заказа.
* Метод `setContacts` и `setDelivery` — отображение данных в финальном окне.

## types/index.ts
**Назначение:** определения всех используемых в приложении типов и интерфейсов.
### `CatalogItemStatus`
* Тип, описывающий категории товаров (строгий перечень значений).
### `IProduct`
* Интерфейс карточки товара:
  * `id` — уникальный идентификатор товара.
  * `title` — название товара.
  * `image` — изображение товара.
  * `price` — цена товара.
  * `description` — описание товара.
  * `category` — категория товара.

### `IOrderForm` / `IOrderContact` / `IOrder`
* Интерфейсы для заказа и его полей:
  * `IOrderForm` — структура формы для оформления заказа.
  * `IOrderContact` — структура для контактных данных (почта, телефон, адрес).
  * `IOrder` — интерфейс для заказа, включает список товаров, общую сумму и данные пользователя.

### `IOrderAnswer`
* Интерфейс ответа сервера при оформлении заказа:
  * Структура ответа при успешной отправке данных заказа.

### `IAppState`
* Интерфейс для состояния приложения:
  * `catalog` — состояние каталога товаров.
  * `basket` — состояние корзины.
  * `order` — текущее состояние заказа.

### `IStoreApi`
* Интерфейс API:
  * `getProductList` — метод для получения списка товаров.
  * `submitOrder` — метод для отправки данных заказа.

### `IPage`
* Структура для основных DOM-контейнеров на странице:
  * `catalog` — контейнер для отображения каталога товаров.
  * `basket` — контейнер для отображения корзины.
  * `order` — контейнер для отображения формы оформления заказа.

### `FormErrors`
* Тип частичной мапы ошибок формы:
  * Используется для отслеживания ошибок валидации в формах.

  ## src/app.ts
**Назначение:** инициализация базовых компонентов приложения.
### `App`
* Главный контроллер UI, который управляет основными компонентами приложения.
* Создаёт всплывающее окно (`Popup`) и корзину (`Cart`).
* Загружает каталог товаров с помощью события `catalog:load`.
* Подписывается на событие `basket:opened`, чтобы отобразить корзину в модальном окне.

### Основные действия:
* Инициализация каталога товаров при загрузке страницы.
* Управление состоянием корзины, отображение её в модальном окне по требованию.

## components/base/api.ts
**Назначение:** базовый класс для работы с API сервера.
### Api
* Обрабатывает GET и POST запросы к серверу
* Конструктор принимает базовый URL и опции запроса
* Методы:
  - `get(uri)` - выполняет GET запрос
  - `post(uri, data, method)` - выполняет POST/PUT/DELETE запрос
  - `handleResponse(response)` - обрабатывает ответ сервера (успешный/ошибка)

## components/base/component.ts
**Назначение:** абстрактный базовый класс для всех UI компонентов.
### UiComponent
* Предоставляет общие методы для работы с DOM:
  - `changeClassState()` - управление CSS классами
  - `updateTextContent()` - обновление текста элемента
  - `changeDisabledState()` - управление состоянием disabled
  - `hideElement()/showElement()` - скрытие/показ элементов
  - `configureImage()` - настройка изображений
  - `draw()` - основная метода отрисовки компонента

## components/base/events.ts
**Назначение:** реализация событийной модели (EventEmitter).
### EventEmitter
* Позволяет подписываться и генерировать события
* Основные методы:
  - `on()` - подписка на событие
  - `off()` - отмена подписки
  - `emit()` - генерация события
  - `onAll()` - подписка на все события
  - `trigger()` - создание триггера события

## components/base/model.ts
**Назначение:** базовый класс для моделей данных.
### Model
* Наследуется всеми моделями приложения
* Принимает начальные данные и экземпляр EventEmitter
* Метод `emitChanges()` - уведомляет подписчиков об изменениях

## data/basket.ts
**Назначение:** представление корзины товаров.
### Cart
* Управляет отображением списка товаров в корзине
* Обновляет общую сумму заказа
* Контролирует состояние кнопки оформления заказа
* Основные свойства:
  - `setItems` - обновляет список товаров
  - `updateTotal` - устанавливает общую сумму
  - `selectedItems` - управляет кнопкой оформления

## data/order.ts
**Назначение:** форма оформления заказа (доставка и оплата).
### OrderForm
* Наследуется от FormHandler
* Управляет выбором способа оплаты
* Устанавливает адрес доставки
* Основные свойства:
  - `selectedPayment` - выбранный метод оплаты
  - `deliveryAddress` - адрес доставки

## data/success.ts
**Назначение:** подтверждение успешного оформления заказа.
### PurchaseConfirmation
* Отображает информацию о списанной сумме
* Обрабатывает закрытие окна подтверждения
* Основные свойства:
  - `transactionAmount` - сумма списания

Файл `utils.ts`:
* `ensureElement` — безопасное получение одного элемента
* `ensureAllElements` — безопасное получение нескольких
* `cloneTemplate` — клонирование шаблона
* `createElement` — создание элемента
* `setElementData`, `getElementData` — работа с data-атрибутами
* `pascalToKebab`, `isPlainObject`, `isBoolean`, `isEmpty` — проверки типов

# Важные файлы проекта
src
---components
-----base
-------api.ts
-------component.ts
-------events.ts
-------model.ts
----data
-------api.ts
-------app.ts
-------basket.ts
-------card.ts
-------contacts.ts
-------form.ts
-------modal.ts
-------order.ts
-------page.ts
-------success.ts
----types
-------index.ts
----utils
-------utils.ts
-------constants.ts
app.ts
index.ts

# Установка и запуск
```bash
npm install
npm run dev
```
